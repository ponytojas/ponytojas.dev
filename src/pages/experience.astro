---
import SiteLayout from "@/layouts/SiteLayout.astro";
import { experiences } from "@/data/experiences";
---

<SiteLayout title="Experience | Daniel Villalobos" description="Experience of Daniel Villalobos">
  <div class="py-24 md:py-32">
    <div class="container-custom">
      <div class="mb-16 md:mb-20">
        <span
          class="section-number text-sm font-mono text-brand-accent uppercase tracking-widest inline-flex items-center gap-2 mb-6 text-reveal"
          data-text-reveal
        >
          <span class="bauhaus-square bauhaus-square-animated"></span>
          Experience
        </span>
        <h1
          class="text-4xl sm:text-5xl md:text-6xl lg:text-7xl font-heading font-bold text-foreground tracking-tight text-reveal"
          style="--reveal-delay: 90ms;"
          data-text-reveal
        >
          Where I&apos;ve worked
        </h1>
      </div>

      <div class="border-t border-border">
        {
          experiences.map((experience) => {
            const Component = experience.Component;
            const { metadata } = experience;

            return (
              <details class="group collapsible border-b border-border py-6 md:py-8">
                <summary class="list-none cursor-pointer">
                  <div class="grid grid-cols-1 md:grid-cols-[180px_1fr] gap-4 md:gap-8 items-start">
                    <div class="flex flex-col gap-1">
                      <span class="text-sm font-mono text-muted-foreground">{metadata.time}</span>
                      {
                        metadata.link ? (
                          <a
                            href={metadata.link}
                            target="_blank"
                            rel="noopener noreferrer"
                            class="inline-flex items-center gap-1 text-xs text-muted-foreground/60 hover:text-foreground transition-colors"
                          >
                            <span>Visit</span>
                            <span aria-hidden="true">â†—</span>
                          </a>
                        ) : null
                      }
                    </div>

                    <div class="flex items-start justify-between gap-4">
                      <div class="flex flex-col gap-1">
                        <h3 class="text-xl md:text-2xl font-medium text-foreground">{metadata.position}</h3>
                        <p
                          class="experience-company"
                          style={`--company-color: ${metadata.color}; --company-color-dark: ${metadata.darkColor ?? metadata.color};`}
                        >
                          {metadata.title}
                        </p>
                      </div>
                      <span class="collapse-icon text-brand-accent text-lg shrink-0" aria-hidden="true">+</span>
                    </div>
                  </div>
                </summary>

                <div class="collapse-panel">
                  <div class="collapse-panel-inner pt-6 md:pt-8 grid grid-cols-1 md:grid-cols-[180px_1fr] gap-4 md:gap-8">
                    <div></div>
                    <div class="flex flex-col gap-6">
                      {
                        metadata.tags && metadata.tags.length > 0 ? (
                          <div class="flex flex-wrap gap-2 mt-2">
                            {metadata.tags.map((tag) => (
                              <span class="tech-badge text-xs font-mono px-3 py-1.5 rounded-full border border-border text-muted-foreground">
                                {tag.technology}
                              </span>
                            ))}
                          </div>
                        ) : null
                      }

                      <div class="prose prose-sm dark:prose-invert max-w-none text-muted-foreground">
                        <Component />
                      </div>
                    </div>
                  </div>
                </div>
              </details>
            );
          })
        }
      </div>
    </div>
  </div>
</SiteLayout>
