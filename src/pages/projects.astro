---
import SiteLayout from "@/layouts/SiteLayout.astro";
import { projects } from "@/data/projects";
import LabtoolsProject from "@/app/projects/labtools.mdx";
import DiunProject from "@/app/projects/diun.mdx";
import FlappyBallProject from "@/app/projects/flappy-ball.mdx";
import MyTasksProject from "@/app/projects/my-tasks.mdx";
---

<SiteLayout title="Projects | Daniel Villalobos" description="Projects by Daniel Villalobos">
  <div class="py-24 md:py-32">
    <div class="container-custom">
      <div class="mb-16 md:mb-20">
        <span
          class="section-number text-sm font-mono text-brand-accent uppercase tracking-widest inline-flex items-center gap-2 mb-6 text-reveal"
          data-text-reveal
        >
          <span class="bauhaus-dot bauhaus-dot-animated"></span>
          Projects
        </span>
        <h1
          class="text-4xl sm:text-5xl md:text-6xl lg:text-7xl font-heading font-bold text-foreground tracking-tight text-reveal"
          style="--reveal-delay: 90ms;"
          data-text-reveal
        >
          Things I&apos;ve built
        </h1>
      </div>

      <div class="border-t border-border">
        {
          projects.map((project) => {
            const { metadata } = project;

            return (
              <details class="group collapsible border-b border-border py-6 md:py-8">
                <summary class="list-none cursor-pointer">
                  <div class="flex items-start justify-between gap-6">
                    <div class="flex-1">
                      <div class="flex flex-col sm:flex-row sm:items-start sm:justify-between gap-2 mb-1">
                        <h3 class="text-xl md:text-2xl font-medium text-foreground">{metadata.title}</h3>
                        {metadata.type ? <span class="text-xs font-mono text-muted-foreground/60 shrink-0">{metadata.type}</span> : null}
                      </div>
                      {metadata.subtitle ? <p class="text-muted-foreground">{metadata.subtitle}</p> : null}
                    </div>
                    <span class="collapse-icon text-brand-accent text-lg" aria-hidden="true">+</span>
                  </div>
                </summary>

                <div class="collapse-panel">
                  <div class="collapse-panel-inner pt-6 md:pt-8 flex flex-col gap-6">
                    {
                      metadata.tags && metadata.tags.length > 0 ? (
                        <div class="flex flex-wrap gap-2">
                          {metadata.tags.map((tag) => (
                            <span class="tech-badge text-xs font-mono px-3 py-1.5 rounded-full border border-border text-muted-foreground">
                              {tag.technology}
                            </span>
                          ))}
                        </div>
                      ) : null
                    }

                    <div class="prose prose-sm dark:prose-invert max-w-none text-muted-foreground">
                      {project.id === "labtools" ? <LabtoolsProject client:load /> : null}
                      {project.id === "diun" ? <DiunProject client:load /> : null}
                      {project.id === "flappy-ball" ? <FlappyBallProject client:load /> : null}
                      {project.id === "my-tasks" ? <MyTasksProject client:load /> : null}
                    </div>

                    {
                      metadata.link ? (
                        <a
                          href={metadata.link}
                          target="_blank"
                          rel="noopener noreferrer"
                          class="inline-flex items-center gap-2 text-sm font-medium text-foreground hover:text-brand-accent transition-colors w-fit"
                        >
                          <span>View project</span>
                          <span aria-hidden="true">â†—</span>
                        </a>
                      ) : null
                    }
                  </div>
                </div>
              </details>
            );
          })
        }
      </div>
    </div>
  </div>
</SiteLayout>
